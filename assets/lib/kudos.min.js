!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){function t(e){return s.raw?e:encodeURIComponent(e)}function n(e){return s.raw?e:decodeURIComponent(e)}function r(e){return t(s.json?JSON.stringify(e):String(e))}function o(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(a," ")),s.json?JSON.parse(e):e}catch(t){}}function i(t,n){var r=s.raw?t:o(t);return e.isFunction(n)?n(r):r}var a=/\+/g,s=e.cookie=function(o,a,u){if(void 0!==a&&!e.isFunction(a)){if(u=e.extend({},s.defaults,u),"number"==typeof u.expires){var c=u.expires,d=u.expires=new Date;d.setTime(+d+864e5*c)}return document.cookie=[t(o),"=",r(a),u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join("")}for(var l=o?void 0:{},f=document.cookie?document.cookie.split("; "):[],g=0,h=f.length;h>g;g++){var m=f[g].split("="),_=n(m.shift()),p=m.join("=");if(o&&o===_){l=i(p,a);break}o||void 0===(p=i(p))||(l[_]=p)}return l};s.defaults={},e.removeCookie=function(t,n){return void 0===e.cookie(t)?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}}),!function(){"use strict";function e(){var e=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),e=!0,window.localStorage.removeItem("_tmptest")}catch(t){}if(e)try{window.localStorage&&(v=window.localStorage,C="localStorage",L=v.jStorage_update)}catch(o){}else if("globalStorage"in window)try{window.globalStorage&&(v="localhost"==window.location.hostname?window.globalStorage["localhost.localdomain"]:window.globalStorage[window.location.hostname],C="globalStorage",L=v.jStorage_update)}catch(i){}else{if(y=document.createElement("link"),!y.addBehavior)return void(y=null);y.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(y);try{y.load("jStorage")}catch(a){y.setAttribute("jStorage","{}"),y.save("jStorage"),y.load("jStorage")}var u="{}";try{u=y.getAttribute("jStorage")}catch(c){}try{L=y.getAttribute("jStorage_update")}catch(f){}v.jStorage=u,C="userDataBehavior"}s(),d(),n(),l(),"addEventListener"in window&&window.addEventListener("pageshow",function(e){e.persisted&&r()},!1)}function t(){var e="{}";if("userDataBehavior"==C){y.load("jStorage");try{e=y.getAttribute("jStorage")}catch(t){}try{L=y.getAttribute("jStorage_update")}catch(n){}v.jStorage=e}s(),d(),l()}function n(){"localStorage"==C||"globalStorage"==C?"addEventListener"in window?window.addEventListener("storage",r,!1):document.attachEvent("onstorage",r):"userDataBehavior"==C&&setInterval(r,1e3)}function r(){var e;clearTimeout(O),O=setTimeout(function(){if("localStorage"==C||"globalStorage"==C)e=v.jStorage_update;else if("userDataBehavior"==C){y.load("jStorage");try{e=y.getAttribute("jStorage_update")}catch(t){}}e&&e!=L&&(L=e,o())},25)}function o(){var e,n=j.parse(j.stringify(S.__jstorage_meta.CRC32));t(),e=j.parse(j.stringify(S.__jstorage_meta.CRC32));var r,o=[],a=[];for(r in n)if(n.hasOwnProperty(r)){if(!e[r]){a.push(r);continue}n[r]!=e[r]&&"2."==String(n[r]).substr(0,2)&&o.push(r)}for(r in e)e.hasOwnProperty(r)&&(n[r]||o.push(r));i(o,"updated"),i(a,"deleted")}function i(e,t){e=[].concat(e||[]);var n,r,o,i;if("flushed"==t){e=[];for(var a in T)T.hasOwnProperty(a)&&e.push(a);t="deleted"}for(n=0,o=e.length;o>n;n++){if(T[e[n]])for(r=0,i=T[e[n]].length;i>r;r++)T[e[n]][r](e[n],t);if(T["*"])for(r=0,i=T["*"].length;i>r;r++)T["*"][r](e[n],t)}}function a(){var e=(+new Date).toString();if("localStorage"==C||"globalStorage"==C)try{v.jStorage_update=e}catch(t){C=!1}else"userDataBehavior"==C&&(y.setAttribute("jStorage_update",e),y.save("jStorage"));r()}function s(){if(v.jStorage)try{S=j.parse(String(v.jStorage))}catch(e){v.jStorage="{}"}else v.jStorage="{}";b=v.jStorage?String(v.jStorage).length:0,S.__jstorage_meta||(S.__jstorage_meta={}),S.__jstorage_meta.CRC32||(S.__jstorage_meta.CRC32={})}function u(){g();try{v.jStorage=j.stringify(S),y&&(y.setAttribute("jStorage",v.jStorage),y.save("jStorage")),b=v.jStorage?String(v.jStorage).length:0}catch(e){}}function c(e){if("string"!=typeof e&&"number"!=typeof e)throw new TypeError("Key name must be string or numeric");if("__jstorage_meta"==e)throw new TypeError("Reserved key name");return!0}function d(){var e,t,n,r,o=1/0,s=!1,c=[];if(clearTimeout(w),S.__jstorage_meta&&"object"==typeof S.__jstorage_meta.TTL){e=+new Date,n=S.__jstorage_meta.TTL,r=S.__jstorage_meta.CRC32;for(t in n)n.hasOwnProperty(t)&&(n[t]<=e?(delete n[t],delete r[t],delete S[t],s=!0,c.push(t)):n[t]<o&&(o=n[t]));1/0!=o&&(w=setTimeout(d,Math.min(o-e,2147483647))),s&&(u(),a(),i(c,"deleted"))}}function l(){var e,t;if(S.__jstorage_meta.PubSub){var n,r=P,o=[];for(e=t=S.__jstorage_meta.PubSub.length-1;e>=0;e--)n=S.__jstorage_meta.PubSub[e],n[0]>P&&(r=n[0],o.unshift(n));for(e=o.length-1;e>=0;e--)f(o[e][1],o[e][2]);P=r}}function f(e,t){if(k[e])for(var n=0,r=k[e].length;r>n;n++)try{k[e][n](e,j.parse(j.stringify(t)))}catch(o){}}function g(){if(S.__jstorage_meta.PubSub){for(var e=+new Date-2e3,t=0,n=S.__jstorage_meta.PubSub.length;n>t;t++)if(S.__jstorage_meta.PubSub[t][0]<=e){S.__jstorage_meta.PubSub.splice(t,S.__jstorage_meta.PubSub.length-t);break}S.__jstorage_meta.PubSub.length||delete S.__jstorage_meta.PubSub}}function h(e,t){S.__jstorage_meta||(S.__jstorage_meta={}),S.__jstorage_meta.PubSub||(S.__jstorage_meta.PubSub=[]),S.__jstorage_meta.PubSub.unshift([+new Date,e,t]),u(),a()}function m(e,t){for(var n,r=e.length,o=t^r,i=0;r>=4;)n=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24,n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16),n^=n>>>24,n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16),o=1540483477*(65535&o)+((1540483477*(o>>>16)&65535)<<16)^n,r-=4,++i;switch(r){case 3:o^=(255&e.charCodeAt(i+2))<<16;case 2:o^=(255&e.charCodeAt(i+1))<<8;case 1:o^=255&e.charCodeAt(i),o=1540483477*(65535&o)+((1540483477*(o>>>16)&65535)<<16)}return o^=o>>>13,o=1540483477*(65535&o)+((1540483477*(o>>>16)&65535)<<16),o^=o>>>15,o>>>0}var _="0.4.12",p=window.jQuery||window.$||(window.$={}),j={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(e){return String(e).evalJSON()}||p.parseJSON||p.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||p.toJSON};if("function"!=typeof j.parse||"function"!=typeof j.stringify)throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var w,S={__jstorage_meta:{CRC32:{}}},v={jStorage:"{}"},y=null,b=0,C=!1,T={},O=!1,L=0,k={},P=+new Date,D={isXML:function(e){var t=(e?e.ownerDocument||e:0).documentElement;return t?"HTML"!==t.nodeName:!1},encode:function(e){if(!this.isXML(e))return!1;try{return(new XMLSerializer).serializeToString(e)}catch(t){try{return e.xml}catch(n){}}return!1},decode:function(e){var t,n="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(e){var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t};return n?(t=n.call("DOMParser"in window&&new DOMParser||window,e,"text/xml"),this.isXML(t)?t:!1):!1}};p.jStorage={version:_,set:function(e,t,n){if(c(e),n=n||{},"undefined"==typeof t)return this.deleteKey(e),t;if(D.isXML(t))t={_is_xml:!0,xml:D.encode(t)};else{if("function"==typeof t)return void 0;t&&"object"==typeof t&&(t=j.parse(j.stringify(t)))}return S[e]=t,S.__jstorage_meta.CRC32[e]="2."+m(j.stringify(t),2538058380),this.setTTL(e,n.TTL||0),i(e,"updated"),t},get:function(e,t){return c(e),e in S?S[e]&&"object"==typeof S[e]&&S[e]._is_xml?D.decode(S[e].xml):S[e]:"undefined"==typeof t?null:t},deleteKey:function(e){return c(e),e in S?(delete S[e],"object"==typeof S.__jstorage_meta.TTL&&e in S.__jstorage_meta.TTL&&delete S.__jstorage_meta.TTL[e],delete S.__jstorage_meta.CRC32[e],u(),a(),i(e,"deleted"),!0):!1},setTTL:function(e,t){var n=+new Date;return c(e),t=Number(t)||0,e in S?(S.__jstorage_meta.TTL||(S.__jstorage_meta.TTL={}),t>0?S.__jstorage_meta.TTL[e]=n+t:delete S.__jstorage_meta.TTL[e],u(),d(),a(),!0):!1},getTTL:function(e){var t,n=+new Date;return c(e),e in S&&S.__jstorage_meta.TTL&&S.__jstorage_meta.TTL[e]?(t=S.__jstorage_meta.TTL[e]-n,t||0):0},flush:function(){return S={__jstorage_meta:{CRC32:{}}},u(),a(),i(null,"flushed"),!0},storageObj:function(){function e(){}return e.prototype=S,new e},index:function(){var e,t=[];for(e in S)S.hasOwnProperty(e)&&"__jstorage_meta"!=e&&t.push(e);return t},storageSize:function(){return b},currentBackend:function(){return C},storageAvailable:function(){return!!C},listenKeyChange:function(e,t){c(e),T[e]||(T[e]=[]),T[e].push(t)},stopListening:function(e,t){if(c(e),T[e]){if(!t)return void delete T[e];for(var n=T[e].length-1;n>=0;n--)T[e][n]==t&&T[e].splice(n,1)}},subscribe:function(e,t){if(e=(e||"").toString(),!e)throw new TypeError("Channel not defined");k[e]||(k[e]=[]),k[e].push(t)},publish:function(e,t){if(e=(e||"").toString(),!e)throw new TypeError("Channel not defined");h(e,t)},reInit:function(){t()},noConflict:function(e){return delete window.$.jStorage,e&&(window.jStorage=this),this}},e()}(),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e){this.element=e,this.unkudo=t(this.unkudo,this),this.complete=t(this.complete,this),this.end=t(this.end,this),this.start=t(this.start,this),this.bindEvents(),this.counter=$(".count .num",this.element),this.element.data("kudoable",this)}return e.prototype.bindEvents=function(){return this.element.mouseenter(this.start),this.element.mouseleave(this.end),this.element.click(this.unkudo),$(this.element).on("touchstart",this.element,this.start),$(this.element).on("touchend",this.element,this.end)},e.prototype.isKudoable=function(){return this.element.hasClass("kudoable")},e.prototype.isKudod=function(){return this.element.hasClass("complete")},e.prototype.start=function(){return this.isKudoable()&&!this.isKudod()?(this.element.trigger("kudo:active"),this.element.addClass("active"),this.timer=setTimeout(this.complete,700)):void 0},e.prototype.end=function(){return this.isKudoable()&&!this.isKudod()&&(this.element.trigger("kudo:inactive"),this.element.removeClass("active"),null!=this.timer)?clearTimeout(this.timer):void 0},e.prototype.complete=function(){return this.end(),this.incrementCount(),this.element.addClass("complete"),this.element.trigger("kudo:added")},e.prototype.unkudo=function(e){return e.preventDefault(),this.isKudod()?(this.decrementCount(),this.element.removeClass("complete"),this.element.trigger("kudo:removed")):void 0},e.prototype.setCount=function(e){return this.counter.html(e)},e.prototype.currentCount=function(){return parseInt(this.counter.html())},e.prototype.incrementCount=function(){return this.setCount(this.currentCount()+1)},e.prototype.decrementCount=function(){return this.setCount(this.currentCount()-1)},e}(),jQuery(function(t){return t.fn.kudoable=function(){return this.each(function(){return new e(t(this))})}})}.call(this);